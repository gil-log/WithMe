<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="letterMapper">
	
	<!-- letterlist 확인 (LR1은 수신자, LR2는 발신자)-->	
	<select id="letterlist" resultType="com.withme.vo.LetterlistVO">
		SELECT L.L_ID, LR1.U_ID, L.L_MESSAGE, L.L_FLAG, L.L_TITLE, LR1.SEND_FLAG, LR2.U_ID "sender_id"
		FROM LETTER_TB L, LETTERING_TB LR1, LETTERING_TB LR2
		WHERE LR1.U_id = 'test1' 
		AND L.L_ID = LR1.L_ID
		AND LR1.L_ID = LR2.L_ID
		AND LR2.SEND_FLAG = 1
		ORDER BY L.L_ID DESC
	</select>
	
	<insert id="insertletter">
	INSERT INTO LETTER_TB(   L_ID
   					       , L_MESSAGE
   					       , L_FLAG
	   					   , L_TITLE
	   					   , L_DATE
	   					 )
                   VALUES(   L_ID_SEQ.NEXTVAL 
	                 		 , #{L_MESSAGE}
	                 		 , #{L_FLAG}
	                 		 , #{L_TITLE}
	                 		 , SYSDATE	
	                 	 )
   </insert>
	
	
</mapper>